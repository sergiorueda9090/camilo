{% extends 'main/base.html' %}
{% load text_filters %}

{% block title %}Dr. Camilo Soler Rueda | Criterio Legal y Politico{% endblock %}

{% block header %}
<!-- HEADER HOME -->
<header class="header-home">
  <h1>Camilo Soler Rueda</h1>
  <p>Derecho &middot; Politica &middot; Pensamiento Critico</p>
  <nav class="nav-links mt-4">
    <a href="#">Analisis</a>
    <a href="#">Jurisprudencia</a>
    <a href="#">Publicaciones</a>
    <a href="#">Contacto</a>
  </nav>
</header>
{% endblock %}

{% block content %}
<!-- CONTENIDO -->
<main class="container my-5">
  <div class="row g-5">
    <div class="col-lg-8 article">
      {% if articulo_destacado %}
      {% if articulo_destacado.imagen_destacada %}
      <img src="{{ articulo_destacado.imagen_destacada.url }}" alt="{{ articulo_destacado.titulo }}">
      {% endif %}
      <h2>{{ articulo_destacado.titulo }}</h2>
      {% if articulo_destacado.subtitulo %}
      <p class="lead">{{ articulo_destacado.subtitulo }}</p>
      {% endif %}
      <p>{{ articulo_destacado.contenido|striptags|decode_entities|truncatewords:50 }}</p>
      <a href="{% url 'articulo_detalle' articulo_destacado.slug %}" class="btn-editorial mt-3">Leer columna completa</a>
      {% else %}
      <p class="text-muted">No hay articulos publicados.</p>
      {% endif %}
    </div>

    <aside class="col-lg-4">

      <!-- PERFIL DEL AUTOR -->
      {% if perfil %}
      <div class="author-box mb-4 text-center">
        {% if perfil.foto %}
        <img src="{{ perfil.foto.url }}" alt="{{ perfil.nombre_completo }}">
        {% else %}
        <img src="https://images.unsplash.com/photo-1560250097-0b93528c311a?auto=format&fit=crop&w=300" alt="{{ perfil.nombre_completo }}">
        {% endif %}
        <h5 class="mt-3">{{ perfil.nombre_completo }}</h5>
        <p class="small text-muted">{{ perfil.descripcion }}</p>
        {% if perfil.firma %}
        <div class="signature mt-2">{{ perfil.firma }}</div>
        {% endif %}
      </div>
      {% endif %}

      <!-- CAPSULAS JURIDICAS -->
      {% if capsulas %}
      <div class="capsules-box">
        <h6 class="capsules-title">Capsulas Juridicas</h6>

        {% for capsula in capsulas %}
        <div class="capsule-item">
          <h6>{{ capsula.titulo }}</h6>
          <p>{{ capsula.contenido }}</p>
        </div>
        {% endfor %}

      </div>
      {% endif %}

    </aside>
  </div>
</main>

<!-- ARCHIVO EDITORIAL -->
{% if articulos_archivo %}
<section class="archive">
  <div class="container">
    <h3 class="mb-5">Archivo Editorial</h3>
    <div class="row g-4">

      {% for articulo in articulos_archivo %}
      <div class="col-md-4">
        <div class="archive-card">
          {% if articulo.imagen_destacada %}
          <img src="{{ articulo.imagen_destacada.url }}" alt="{{ articulo.titulo }}">
          {% else %}
          <img src="https://images.unsplash.com/photo-1505664194779-8beaceb93744?auto=format&fit=crop&w=400" alt="{{ articulo.titulo }}">
          {% endif %}
          <div class="p-4">
            <div class="archive-meta mb-2">{{ articulo.fecha_publicacion|date:"F Y" }}</div>
            <h5>{{ articulo.titulo }}</h5>
            <p class="small text-muted">
              {% if articulo.subtitulo %}
              {{ articulo.subtitulo|truncatewords:15 }}
              {% else %}
              {{ articulo.contenido|striptags|decode_entities|truncatewords:15 }}
              {% endif %}
            </p>
            <a href="{% url 'articulo_detalle' articulo.slug %}" class="btn-editorial btn-sm mt-2">Leer</a>
          </div>
        </div>
      </div>
      {% endfor %}

    </div>
  </div>
</section>
{% endif %}
{% endblock %}
